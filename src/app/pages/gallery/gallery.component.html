<section class="gallery-page">
  <div class="container">

    <div class="page-header">
      <h1 class="page-title">{{ getTranslation('gallery.title') }}</h1>
    </div>

    <div class="gallery-filters" *ngIf="galleries().length > 0">
      <button
        *ngFor="let gallery of galleries()"
        class="filter-btn"
        [class.active]="activeTab() === gallery._id"
        (click)="setActiveTab(gallery._id)"
      >
        {{ getLocalizedTitle(gallery) }}
      </button>
    </div>

    <!-- Gallery Grid -->
    <div 
      *ngIf="activeGallery() as gallery"
      class="gallery"
    >
      <div 
        *ngFor="let photo of gallery.photos; let i = index"
        class="gallery-item"
        (click)="openModal(gallery.photos, i)"
      >
        <img 
          [src]="photo.asset.url || ''" 
          [alt]="photo.alt || getLocalizedTitle(gallery) + ' - Photo ' + (i + 1)"
          loading="lazy"
        />
      </div>
    </div>

    <div class="no-photos" *ngIf="galleries().length === 0">
      <div class="no-photos-content">
        <i class="fas fa-images"></i>
        <h3>{{ getTranslation('gallery.emptyTitle') }}</h3>
        <p>{{ getTranslation('gallery.emptyText') }}</p>
      </div>
    </div>
  </div>

  <!-- Custom Modal -->
  <div 
    *ngIf="isModalOpen()"
    class="photo-modal-overlay"
    (click)="closeModal()"
  >
    <div class="photo-modal-content" (click)="$event.stopPropagation()">
      <!-- Close button -->
      <button class="modal-close" (click)="closeModal()">
        <i class="fas fa-times"></i>
      </button>

      <!-- Counter -->
      <div class="modal-counter">
        {{ currentIndex() + 1 }} / {{ allPhotos().length }}
      </div>

      <!-- Navigation buttons -->
      <button 
        *ngIf="currentIndex() > 0"
        class="modal-nav modal-prev"
        (click)="prevPhoto()"
      >
        <i class="fas fa-chevron-left"></i>
      </button>

      <button 
        *ngIf="currentIndex() < allPhotos().length - 1"
        class="modal-nav modal-next"
        (click)="nextPhoto()"
      >
        <i class="fas fa-chevron-right"></i>
      </button>

      <!-- Image -->
      <div class="modal-image-container">
        <img 
          [src]="currentPhoto()?.asset?.url || ''"
          [alt]="currentPhoto()?.alt || 'Photo'"
          class="modal-image"
        />
      </div>
    </div>
  </div>
</section>